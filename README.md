# CVE-2022-30190
aka Follina

## 漏洞說明
>Follina存在於微軟支援診斷工具（Microsoft Support Diagnostic Tool，MSDT）中，當有應用程式透過URL協定呼叫MSDT進行支援時，就會出現遠端程式攻擊漏洞，成功的開採將允許駭客基於所執行應用程式的權限，來執行任意程式。

## 漏洞復現環境
```
* Host OS: Ubuntu 22.04 LST
* Guest OS: Windows 10 Pro x64, version 2004, build 19041.1237
* Microsoft office: word 2016
```

## 復現流程
### 製作惡意文件
Step1 創建 word 文件(.docx)，並在文中插入 OLE 物件(如:Bitmap Image)
<img src=[https://img-blog.csdnimg.cn/20200822014538211.png](https://user-images.githubusercontent.com/39819798/218609353-43aad2aa-d029-4278-a72a-9c432f17f846.png) width=60% />

Step2 解壓縮 .docx 文件，編輯 word/_rels/document.xml.rels

```
* Host OS: Ubuntu 22.04 LST
* Guest OS: Windows 10 x64 Professional SP1
* Microsoft office: word 2016
```



## 參考文件
[新聞說明](https://www.ithome.com.tw/news/151494)
[Follina.py](https://github.com/JohnHammond/msdt-follina)  
[malicious document](https://github.com/JMousqueton/PoC-CVE-2022-30190)  
[漏洞測試1](https://www.huntress.com/blog/microsoft-office-remote-code-execution-follina-msdt-bug)  
[漏洞測試2](https://www.loadcaps.com/posts/c1f2e5c1.html#%E5%BC%80%E5%A7%8B%E5%A4%8D%E7%8E%B0)  
[漏洞測試3](https://www.youtube.com/watch?v=36vMVYnIFxQ) 
